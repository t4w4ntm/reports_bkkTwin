<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Submit Report | BangkokTwin</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                        orbitron: ['Orbitron', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Orbitron:wght@600;800&display=swap" rel="stylesheet">

    <style>
        html, body { height: 100%; }
        body {
            font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', sans-serif;
            background: #0b1220;
            color: #e6f0ff;
        }

        /* Ambient mesh background — soft & subtle (no canvas) */
        .bg-ambient {
            position: fixed; inset: 0; z-index: -10; opacity: .65;
            background:
                radial-gradient(35rem 25rem at 20% 15%, rgba(34,197,94,.25), transparent 60%),
                radial-gradient(45rem 35rem at 80% 10%, rgba(56,189,248,.20), transparent 60%),
                radial-gradient(50rem 35rem at 70% 85%, rgba(99,102,241,.18), transparent 60%),
                linear-gradient(180deg, #0b1220 0%, #0f1a2e 100%);
            filter: saturate(105%);
            animation: ambientShift 22s ease-in-out infinite alternate;
        }
        @keyframes ambientShift {
            0%   { filter: hue-rotate(0deg) saturate(105%); }
            100% { filter: hue-rotate(12deg) saturate(115%); }
        }
        @media (prefers-reduced-motion: reduce) {
            .bg-ambient { animation: none; }
        }

        /* Glass card feel — iOS-like glowing edge */
        .glass {
            position: relative;
            background: rgba(255,255,255,0.06);
            backdrop-filter: blur(10px) saturate(120%);
            -webkit-backdrop-filter: blur(10px) saturate(120%);
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.08), 0 10px 30px rgba(2,8,23,0.35);
        }
        /* Gradient border using mask so only the edge glows */
        .glass::before {
            content: "";
            position: absolute;
            inset: 0;
            padding: 1px;               /* border width */
            border-radius: inherit;
            background: conic-gradient(from 210deg at 50% 50%,
                rgba(255,255,255,.55),
                rgba(99,102,241,.35),  /* indigo */
                rgba(56,189,248,.35),  /* sky */
                rgba(16,185,129,.40),  /* emerald */
                rgba(255,255,255,.55)
            );
            -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
            mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            pointer-events: none;
            opacity: .55; /* subtle */
        }
        /* Soft highlights for a glassy feel */
        .glass::after {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: inherit;
            background:
                radial-gradient(120% 60% at 0% 0%, rgba(255,255,255,.18), rgba(255,255,255,0) 60%),
                radial-gradient(100% 60% at 100% 0%, rgba(255,255,255,.08), rgba(255,255,255,0) 60%);
            pointer-events: none;
            mix-blend-mode: screen;
            opacity: .5;
        }

        /* Map container sizing */
        #map { width: 100%; height: 480px; }
        /* Tablet */
        @media (max-width: 1024px) {
            #map { height: 420px; }
        }
        /* Mobile */
        @media (max-width: 640px) {
            #map { height: 320px; }
        }

    /* Generic interactive states for clickable elements */
        a, button, [role="button"], label[for] {
            transition: transform .18s ease, box-shadow .2s ease, filter .2s ease, background-color .2s ease, opacity .2s ease;
            will-change: transform, box-shadow, filter;
        }
        a:hover, button:hover, [role="button"]:hover, label[for]:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(2,8,23,.45), 0 0 0 1px rgba(148,163,184,.25) inset, 0 0 16px rgba(56,189,248,.22);
        }
        a:active, button:active, [role="button"]:active, label[for]:active {
            transform: translateY(-1px) scale(0.98);
            filter: brightness(1.03);
        }
        a:focus-visible, button:focus-visible, [role="button"]:focus-visible, label[for]:focus-visible {
            outline: none;
            box-shadow: 0 0 0 3px rgba(56,189,248,.45), 0 0 0 1px rgba(255,255,255,.7) inset;
        }
    </style>
</head>
<body class="min-h-full">
    <div class="bg-ambient"></div>

    <!-- Page wrapper -->
    <div class="relative mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6">
        <!-- Top bar -->
        <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
            <div>
                <div class="flex items-center gap-3">
                    <div class="w-9 h-9 rounded-xl bg-emerald-400/20 ring-1 ring-emerald-400/30 grid place-items-center">
                        <span class="text-emerald-300 font-orbitron font-bold">BT</span>
                    </div>
                    <h1 class="text-2xl font-bold font-orbitron tracking-wide">BangkokTwin — Report</h1>
                </div>
                <p class="text-slate-300/85 text-sm mt-1">Submit an issue with location and optional image.</p>
            </div>
            <div class="flex items-center gap-2">

            </div>
        </div>

        <!-- Content -->
    <div class="mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Form card -->
            <div class="glass rounded-2xl ring-1 ring-white/10 p-5 sm:p-6">
                <h2 class="text-base font-semibold mb-3">Create New Report</h2>
                <form id="reportForm" class="space-y-4">
                    <div>
                        <label for="problemTitle" class="text-xs uppercase tracking-wider text-slate-300/80">ปัญหา (Problem)</label>
                        <input id="problemTitle" name="problemTitle" type="text" required
                            class="mt-1 w-full rounded-xl bg-white/5 ring-1 ring-white/10 focus:ring-emerald-400/40 focus:ring-2 outline-none px-3.5 py-2.5 placeholder:text-slate-400" 
                            placeholder="เช่น ถนนชำรุด, ไฟบนถนนดับ" />
                    </div>

                    <div>
                        <label for="problemDetails" class="text-xs uppercase tracking-wider text-slate-300/80">รายละเอียด (Details)</label>
                        <textarea id="problemDetails" name="problemDetails" rows="5" required
                            class="mt-1 w-full rounded-xl bg-white/5 ring-1 ring-white/10 focus:ring-emerald-400/40 focus:ring-2 outline-none px-3.5 py-2.5 placeholder:text-slate-400" placeholder="โปรดอธิบายปัญหาอย่างละเอียด"></textarea>
                    </div>

                    <div>
                        <label class="text-xs uppercase tracking-wider text-slate-300/80">แนบรูป (Attach Image)</label>
                        <div class="mt-1 flex items-center gap-3">
                            <input type="file" id="problemImage" name="problemImage" accept="image/*" class="hidden" />
                            <label for="problemImage" class="inline-flex items-center gap-2 rounded-xl bg-white/10 hover:bg-white/15 transition px-3.5 py-2 text-sm ring-1 ring-white/10 cursor-pointer">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M20.4 14.5L16 10 4 22"/></svg>
                                Choose File
                            </label>
                            <span id="file-chosen-text" class="text-sm text-slate-300/80">ยังไม่ได้เลือกไฟล์</span>
                        </div>
                    </div>

                    <div>
                        <label class="text-xs uppercase tracking-wider text-slate-300/80">ปักหมุดตำแหน่งในแผนที่ (Pin Location)</label>
                        <p class="text-xs text-slate-400 mt-1">กรุณาคลิกบนแผนที่เพื่อเลือกตำแหน่ง</p>
                        <p id="coordinates-display" class="text-emerald-300 text-sm mt-1"></p>
                    </div>

                    <input type="hidden" id="status" name="status" value="pending" />

                    <button type="submit" class="w-full inline-flex items-center justify-center gap-2 rounded-xl bg-emerald-500/90 hover:bg-emerald-500 transition px-3.5 py-2.5 text-sm font-semibold">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 5v14M5 12h14"/></svg>
                        Submit Report
                    </button>
                </form>
            </div>

            <!-- Map card -->
            <div class="glass rounded-2xl ring-1 ring-white/10 p-5 sm:p-6">
                <h2 class="text-base font-semibold mb-3">Location</h2>
                <div class="relative">
                    <div id="map" class="rounded-xl ring-1 ring-white/10 bg-white/5"></div>
                    <button type="button" id="pin-current-location-btn" title="ใช้ตำแหน่งปัจจุบัน"
                        class="absolute bottom-4 left-4 z-10 inline-flex items-center gap-2 rounded-xl bg-emerald-500/90 hover:bg-emerald-500 text-white shadow-lg shadow-emerald-500/30 transition px-3.5 py-2 text-sm ring-1 ring-emerald-300/50">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 2v4M12 18v4M2 12h4M18 12h4"/><circle cx="12" cy="12" r="3"/></svg>
                        ใช้ตำแหน่งปัจจุบัน
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase (compat v9) -->
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-firestore-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAddqe5R7F1lu-i5JCE6Hk0wWy1M24ryXE",
            authDomain: "reporttwinbkk.firebaseapp.com",
            projectId: "reporttwinbkk",
            storageBucket: "reporttwinbkk.firebasestorage.app",
            messagingSenderId: "495679642018",
            appId: "1:495679642018:web:e2b4c49d1db57f36ebbafb"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
    </script>
    <script src="script.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAPd8UeMjK_euJp_jasQCPFmQQHicmH-c4&callback=initMap" async defer></script>
    
    <!-- Toast (Tailwind) -->
    <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 z-[60] hidden">
        <div id="toastText" class="rounded-xl bg-black/80 text-white px-4 py-2 text-sm ring-1 ring-white/15">Saved</div>
    </div>
</body>
</html>